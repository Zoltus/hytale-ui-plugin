<idea-plugin>
  <id>de.bungee.idea.plugins.uifile</id>
  <name>Hytale .ui Support</name>
  <vendor email="contact@lyndara.net"
    url="https://github.com/BungeeDEV/hytale-ui-plugin">
    BungeeDEV
  </vendor>
  <description><![CDATA[
    Syntax highlighting and IDE support for .ui files used in UI definitions.
    <br/><br/>
    This plugin provides comprehensive support for .ui files, making it easier to work with UI component definitions in your IDE.
    <br/><br/>
    <b>Features:</b>
    <ul>
      <li>Syntax highlighting for UI components (Group, Label, Button, TextInput)</li>
      <li>Recognition and highlighting of properties (Anchor, Background, Text, Style, etc.)</li>
      <li>Color preview for hex color values with inline color squares</li>
      <li><b>Interactive color picker</b> - Click color gutter icons or use Alt+Enter to change colors visually</li>
      <li>Brace matching for {} and () blocks</li>
      <li>Code folding for nested {} blocks</li>
      <li>File type registration for .ui extension</li>
    </ul>
    ]]></description>
  <change-notes><![CDATA[
    <h3>Version 1.2.2</h3>
    <ul>
      <li><b>NEW: Interactive Color Picker</b> - Click on color gutter icons to open color picker dialog</li>
      <li>Change colors visually with IntelliJ's native color picker</li>
      <li>Support for an alpha channel (transparency) in colors</li>
      <li>Intention action "Choose color" available via Alt+Enter on color values</li>
      <li>Real-time code updates when selecting new colors</li>
      <li>Enhanced tooltip showing RGB/RGBA values on hover</li>
      <li><b>IMPROVED: Preview System</b> - Simplified UI model and renderer structure for better performance</li>
      <li>Enhanced component layout handling in a preview panel</li>
      <li>Improved code clarity and maintainability of preview components</li>
      <li>Better style handling for UI components in live preview</li>
    </ul>
    <h3>Version 1.2.1</h3>
    <ul>
      <li><b>NEW: Code Reformatting Support</b> - Full support for Ctrl+Alt+L / Cmd+Option+L in .ui files</li>
      <li>Smart spacing for components, properties, and values</li>
      <li>Hierarchical AST parsing for improved nesting and indentation</li>
      <li>Fixed various indentation and spacing bugs during reformat</li>
    </ul>
    <h3>Version 1.2.0</h3>
    <ul>
      <li><b>NEW: Live Preview Tool Window</b> - Visual rendering of .ui files with real-time updates</li>
      <li>Real-time preview updates while typing in the editor</li>
      <li>Professional UI component rendering (Group, Label, Button, TextField)</li>
      <li>Zoom controls (+, -, Reset to 100%)</li>
      <li>Accurate color and size rendering from .ui syntax</li>
      <li>Preview panel positioned on the right side of the IDE</li>
      <li><b>NEW: Create New UI File Action</b> - Right-click context menu to create .ui files</li>
      <li>Automatic .ui extension handling for new files</li>
      <li>Smart directory detection (selected folder, parent directory, or project root)</li>
      <li><b>NEW: Plugin Settings Page</b> - Configure UI File plugin behavior</li>
      <li>Toggle "New File" action on/off in settings</li>
      <li>Settings accessible via Settings → Tools → Hytale UI File</li>
      <li><b>FIXED:</b> Improved directory determination logic for new file creation</li>
      <li><b>FIXED:</b> Enhanced error handling for invalid directory scenarios</li>
      <li><b>FIXED:</b> Resource bundle integration for internationalization support</li>
    </ul>
    <h3>Version 1.1.0</h3>
    <ul>
      <li><b>NEW: IntelliSense/Code Completion</b> - Comprehensive auto-completion support for UI files</li>
      <li>Component type suggestions (Group, Label, Button, TextField, Image, CheckBox, Slider, Panel, ScrollView)</li>
      <li>Context-aware property suggestions based on current component type</li>
      <li>Property descriptions and type information in the completion popup</li>
      <li>Smart value templates for different property types (colors, strings, numbers, etc.)</li>
      <li>Automatic cursor positioning after insertion</li>
      <li>Extended property definitions for all UI component types</li>
    </ul>
    <h3>Version 1.0.3</h3>
    <ul>
      <li>Version update to 1.0.3</li>
      <li>Minor bug fixes and performance improvements</li>
      <li>Added a build script for GitHub Releases</li>
    </ul>
    <h3>Version 1.0.2</h3>
    <ul>
      <li>Added color preview gutter icons for hex color values (#RGB, #RRGGBB, #RRGGBBAA)</li>
      <li>Hover over color icons to see RGB/RGBA values</li>
    </ul>
    <h3>Version 1.0.1</h3>
    <ul>
      <li>Extended IDE compatibility: Now supports IntelliJ IDEA builds 251 through 253.*</li>
      <li>Enhanced JDK compatibility: Plugin builds correctly with JDK 17, 21, and 25</li>
      <li>Fixed compatibility issue with IntelliJ IDEA 2025.3 (build 253.*)</li>
    </ul>
    <h3>Version 1.0.0</h3>
    <ul>
      <li>Initial release with syntax highlighting for .ui files</li>
      <li>Support for UI components and properties</li>
      <li>Bracket matching and code folding</li>
    </ul>
    ]]></change-notes>
  <!-- Requires IntelliJ Platform -->
  <depends>com.intellij.modules.platform</depends>
  <extensions defaultExtensionNs="com.intellij">
    <!-- File Type Registration -->
    <fileType
      name="UI File"
      implementationClass="de.bungee.uifile.UIFileType"
      fieldName="INSTANCE"
      language="UI"
      extensions="ui"/>
    <!-- Language Definition -->
    <lang.parserDefinition
      language="UI"
      implementationClass="de.bungee.uifile.parser.UIParserDefinition"/>
    <!-- Syntax Highlighter -->
    <lang.syntaxHighlighterFactory
      language="UI"
      implementationClass="de.bungee.uifile.highlighter.UISyntaxHighlighterFactory"/>
    <!-- Color Settings Page -->
    <colorSettingsPage
      implementation="de.bungee.uifile.highlighter.UIColorSettingsPage"/>
    <!-- Color Preview Annotator -->
    <annotator
      language="UI"
      implementationClass="de.bungee.uifile.highlighter.UIColorAnnotator"/>
    <!-- Color Picker Intention -->
    <intentionAction>
      <className>
        de.bungee.uifile.highlighter.UIColorChooserIntention
      </className>
      <category>UI file</category>
    </intentionAction>
    <!-- Commenter -->
    <lang.commenter
      language="UI"
      implementationClass="de.bungee.uifile.UICommenter"/>
    <!-- Brace Matcher -->
    <lang.braceMatcher
      language="UI"
      implementationClass="de.bungee.uifile.UIBraceMatcher"/>
    <!-- Code Folding -->
    <lang.foldingBuilder
      language="UI"
      implementationClass="de.bungee.uifile.UIFoldingBuilder"/>
    <!-- Formatter -->
    <lang.formatter
      language="UI"
      implementationClass="de.bungee.uifile.formatting.UIFormattingModelBuilder"/>
    <langCodeStyleSettingsProvider
      implementation="de.bungee.uifile.formatting.UILanguageCodeStyleSettingsProvider"/>
    <!-- Preview Tool Window -->
    <toolWindow
      id="UI Preview"
      anchor="right"
      icon="AllIcons.Actions.Preview"
      factoryClass="de.bungee.uifile.preview.UIPreviewToolWindowFactory"/>

    <!-- Settings Service -->
    <applicationService
      serviceInterface="de.bungee.uifile.settings.UIFileSettings"
      serviceImplementation="de.bungee.uifile.settings.UIFileSettings"/>

    <!-- Settings Page -->
    <applicationConfigurable
      parentId="tools"
      instance="de.bungee.uifile.settings.UIFileSettingsConfigurable"
      id="de.bungee.uifile.settings.UIFileSettingsConfigurable"
      key="settings.displayName"
      bundle="messages.UIFileBundle"/>
  </extensions>

  <actions>
    <!-- New UI File Action -->
    <action id="de.bungee.uifile.action.UIFileAction"
      class="de.bungee.uifile.action.UIFileAction">
      <add-to-group group-id="NewGroup" anchor="after"
        relative-to-action="NewFile"/>
    </action>
  </actions>
</idea-plugin>
